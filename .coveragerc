# https://coverage.readthedocs.io/en/latest/config.html#run
[run]
patch = subprocess
concurrency =
    multiprocessing
    thread
# We use a subdirectory for coverage data to avoid noisy coverage data files.
data_file = .coverage/.coverage
# required to avoid warnings about files created by create_module fixture
include =
    pydantic_ai_slim/**/*.py
    pydantic_evals/**/*.py
    pydantic_graph/**/*.py
    tests/**/*.py
omit =
    tests/example_modules/*.py
    pydantic_ai_slim/pydantic_ai/ext/aci.py  # aci-sdk is too niche to be added as an (optional) dependency
    ; We run durable execution tests in `.coveragerc-durable`.
    pydantic_ai_slim/pydantic_ai/durable_exec/**/*.py
    tests/durable_exec/**/*.py
branch = True
# Disable include-ignored warnings as --source is enabled automatically causing a self conflict as per:
# https://github.com/pytest-dev/pytest-cov/issues/532
# https://github.com/pytest-dev/pytest-cov/issues/369
# This prevents coverage being generated by pytest-cov which has direct editor support in VS Code,
# making it super useful to check coverage while writing tests.
disable_warnings = include-ignored

[paths]
# Allow CI run assets to be downloaded an replicated locally.
source =
    .
    /home/runner/work/pydantic-ai/pydantic-ai
    /System/Volumes/Data/home/runner/work/pydantic-ai/pydantic-ai

# https://coverage.readthedocs.io/en/latest/config.html#report
[report]
fail_under = 100
skip_covered = True
show_missing = True
ignore_errors = True
precision = 2
exclude_lines =
    # `# pragma: no cover` is standard marker for code that's not covered, this will error if code is covered
    pragma: no cover
    # use `# pragma: lax no cover` if you want to ignore cases where (some of) the code is covered
    pragma: lax no cover
    raise NotImplementedError
    if TYPE_CHECKING:
    if typing.TYPE_CHECKING:
    @overload
    @deprecated
    @typing.overload
    @abstractmethod
    \(Protocol\):$
    typing.assert_never
    $\s*assert_never\(
    if __name__ == .__main__.:
    except ImportError as _import_error:
    $\s*pass$
    assert False
    @pytest\.mark\.skip
    @pytest\.mark\.xfail
